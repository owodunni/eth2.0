version: "3"
services:

  beacon-node:
    image: gcr.io/prysmaticlabs/prysm/beacon-chain:latest
    restart: always
    network_mode: "host"
    volumes:
      - beacon-data:/data
    ports:
      - "4000:4000"
      - "13000:13000"
      - "8080:8080"
    command: --datadir=/data

  validator:
    image: gcr.io/prysmaticlabs/prysm/validator:latest
    restart: always
    network_mode: "host"
    depends_on:
      - beacon-node
    volumes:
      - validator-data:/data
    command: --beacon-rpc-provider=beacon-node:4000 \
             --keymanager=keystore \
             --keymanageropts=/data/keystore.json
  
  eth2stat:
    image: alethio/eth2stats-client:latest
    restart: always
    network_mode: "host"
    depends_on:
      - beacon-node
    volumes:
      - eth2stat-data:/data
    command: --eth2stats.node-name="owerdone" \
             --data.folder="/data" \
             --eth2stats.addr="grpc.topaz.eth2stats.io:443" \
             --eth2stats.tls=true \
             --beacon.type="prysm" \
             --beacon.addr="beacon-node:4000" \
             --beacon.metrics-addr="http://beacon-node:8080/metrics"

volumes:
  beacon-data:
  validator-data:
  eth2stat-data:
